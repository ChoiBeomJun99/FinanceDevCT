#SQL(2)(NM)
#테이블(1) REST_INFO 식당정보 : REST_ID, REST_NAME, FOOD_TYPE, VIEWS, FAVORITES,
#                             PARKING_LOT, ADDRESS, TEL
#출력값 : FOOD_TYPE	REST_ID 	REST_NAME	FAVORITES

SELECT A.FOOD_TYPE, A.REST_ID, A.REST_NAME, A.FAVORITES
FROM REST_INFO AS A LEFT JOIN (SELECT FOOD_TYPE, MAX(FAVORITES) AS MAXF
                               FROM REST_INFO GROUP BY FOOD_TYPE) AS B
ON A.FOOD_TYPE=B.FOOD_TYPE
WHERE A.FAVORITES=B.MAXF
ORDER BY A.FOOD_TYPE DESC;

#SQL(2)(CH)
#특정 월의 총 대여횟수가 0이면 결과에서 제외

SELECT MONTH(START_DATE) AS MONTH, CAR_ID, COUNT(*) AS RECORDS
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
WHERE (CAR_ID IN (SELECT DISTINCT CAR_ID
                 FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
                 WHERE DATE_FORMAT(START_DATE,'%Y-%m') BETWEEN '2022-08' AND '2022-10'
                 GROUP BY CAR_ID HAVING COUNT(*)>=5)) AND
      (DATE_FORMAT(START_DATE,'%Y-%m') BETWEEN '2022-08' AND '2022-10')
GROUP BY MONTH(START_DATE), CAR_ID
ORDER BY MONTH ASC, CAR_ID DESC;
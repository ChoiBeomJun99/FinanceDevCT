#SQL(2)(CH)_입양시각구하기
#풀이시간 : 17분
#주의할점 재귀함수 + 0~23 모든 시간대 있어야하는데 GROUP BY로하면 데이터에 있는 값만 !! 주의
#테이블(1) ANIMAL_OUTS - 입양보낸동물정보 : ANIMAL_ID, ANIMAL_TYPE, DATETIME(입양일),
#                                       NAME, SEX_UPON_OUTCOME(성별중성화여부)
#DATE_TIME 시간대쪼개기
#주의할점은 없는시간대에 대해서도 COUNT 해줘야한다는거
WITH RECURSIVE HH AS (
    SELECT 0 AS H
    UNION ALL
    SELECT H+1
    FROM HH
    WHERE H<23)

SELECT A.H AS HOUR,
       (CASE WHEN B.COUNT IS NULL THEN 0 ELSE B.COUNT END) AS COUNT
FROM HH AS A LEFT JOIN
     (SELECT HOUR(DATETIME) AS HOUR, COUNT(DISTINCT ANIMAL_ID) AS COUNT
      FROM ANIMAL_OUTS
      GROUP BY HOUR(DATETIME)) AS B
ON A.H=B.HOUR;


#SQL(2)(NM)_조건에맞는저자와도서출력하기
#풀이시간 : 2분
#테이블(1) BOOK - 판매중인도서정보 : BOOK_ID, CATEGORY, AUTHOR_ID, PRICE, PUBLISHED_DATE
#테이블(2) AUTHOR - 저자정보 : AUTHOR_ID, AUTHOR_NAME
SELECT A.BOOK_ID, B.AUTHOR_NAME,
       DATE_FORMAT(A.PUBLISHED_DATE,'%Y-%m-%d') AS PUBLISHED_DATE
FROM BOOK AS A LEFT JOIN AUTHOR AS B
ON A.AUTHOR_ID=B.AUTHOR_ID
WHERE A.CATEGORY='경제'
ORDER BY PUBLISHED_DATE ASC;
